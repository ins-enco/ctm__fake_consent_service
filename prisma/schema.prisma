generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "linux-musl-openssl-3.0.x"]
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Mt4Daily {
  Login        Int      @map("LOGIN")
  Time         DateTime @map("TIME") @db.DateTime(0)
  Group        String   @map("GROUP") @db.Char(16)
  Bank         String   @map("BANK") @db.Char(64)
  BalancePrev  Float    @map("BALANCE_PREV")
  Balance      Float    @map("BALANCE")
  Deposit      Float    @map("DEPOSIT")
  Credit       Float    @map("CREDIT")
  ProfitClosed Float    @map("PROFIT_CLOSED")
  Profit       Float    @map("PROFIT")
  Equity       Float    @map("EQUITY")
  Margin       Float    @map("MARGIN")
  MarginFree   Float    @map("MARGIN_FREE")
  ModifyTime   DateTime @map("MODIFY_TIME") @db.DateTime(0)

  @@id([Login, Time])
  @@map("mt4_daily")
}

model mt4_group {
  ID        Int      @id @default(autoincrement())
  id_group  Int?
  groupname String?  @db.VarChar(45)
  UseRegex  Boolean?
}

model mt4_prices {
  SYMBOL      String   @id @db.Char(16)
  TIME        DateTime @db.DateTime(0)
  BID         Float
  ASK         Float
  LOW         Float
  HIGH        Float
  DIRECTION   Int
  DIGITS      Int
  SPREAD      Int
  MODIFY_TIME DateTime @db.DateTime(0)
}

model Mt4Trade {
  Ticket          Int      @id @map("TICKET")
  Login           Int      @map("LOGIN")
  SymbolName      String   @map("SYMBOL") @db.Char(16)
  Digits          Int      @map("DIGITS")
  tradeType       Int      @map("CMD")
  VolumeMilliLots Int      @map("VOLUME")
  OpenTime        DateTime @map("OPEN_TIME") @db.DateTime(0)
  OpenPrice       Float    @map("OPEN_PRICE")
  StopLoss        Float    @map("SL")
  TakeProfit      Float    @map("TP")
  CloseTime       DateTime @map("CLOSE_TIME") @db.DateTime(0)
  ExpirationTime  DateTime @map("EXPIRATION") @db.DateTime(0)
  Reason          Int      @default(0) @map("REASON")
  RateOpen        Float    @map("CONV_RATE1")
  RateClose       Float    @map("CONV_RATE2")
  Commission      Float    @map("COMMISSION")
  CommissionAgent Float    @map("COMMISSION_AGENT")
  Swaps           Float    @map("SWAPS")
  ClosePrice      Float    @map("CLOSE_PRICE")
  Profit          Float    @map("PROFIT")
  Taxes           Float    @map("TAXES")
  Comment         String   @map("COMMENT") @db.Char(32)
  internal_id     Int      @map("INTERNAL_ID")
  MarginRate      Float    @map("MARGIN_RATE")
  timeStamp       Int      @map("TIMESTAMP")
  Magic           Int      @default(0) @map("MAGIC")
  gw_volume       Int      @default(0) @map("GW_VOLUME")
  gw_open_price   Int      @default(0) @map("GW_OPEN_PRICE")
  gw_close_price  Int      @default(0) @map("GW_CLOSE_PRICE")
  ModifyTime      DateTime @map("MODIFY_TIME") @db.DateTime(0)

  @@index([CloseTime], map: "INDEX_CLOSETIME")
  @@index([tradeType], map: "INDEX_CMD")
  @@index([Login], map: "INDEX_LOGIN")
  @@index([OpenTime], map: "INDEX_OPENTIME")
  @@index([timeStamp], map: "INDEX_STAMP")
  @@map("mt4_trades")
}

model Mt4Users {
  Login                  Int      @id @map("LOGIN")
  Group                  String   @map("GROUP") @db.Char(16)
  Enabled                Int      @map("ENABLE")
  AllowChangePassword    Int      @map("ENABLE_CHANGE_PASS")
  CloseOnly              Int      @map("ENABLE_READONLY")
  OTPEnabled             Int      @default(0) @map("ENABLE_OTP")
  PhonePassword          String   @map("PASSWORD_PHONE") @db.Char(32)
  Owner                  String   @map("NAME") @db.Char(128)
  Country                String   @map("COUNTRY") @db.Char(32)
  City                   String   @map("CITY") @db.Char(32)
  State                  String   @map("STATE") @db.Char(32)
  ZipCode                String   @map("ZIPCODE") @db.Char(16)
  Address                String   @map("ADDRESS") @db.Char(128)
  LeadSource             String   @default("") @map("LEAD_SOURCE") @db.Char(32)
  Phone                  String   @map("PHONE") @db.Char(32)
  Email                  String   @map("EMAIL") @db.Char(48)
  Comment                String   @map("COMMENT") @db.Char(64)
  PersonalIdentification String   @map("ID") @db.Char(32)
  Status                 String   @map("STATUS") @db.Char(16)
  RegistrationDate       DateTime @map("REGDATE") @db.DateTime(0)
  LastConnectionDate     DateTime @map("LASTDATE") @db.DateTime(0)
  Leverage               Int      @map("LEVERAGE")
  AgentAccountLogin      Int      @map("AGENT_ACCOUNT")
  Timestamp              Int      @map("TIMESTAMP")
  Balance                Float    @map("BALANCE")
  PreviousMonthBalance   Float    @map("PREVMONTHBALANCE")
  PreviousDayBalance     Float    @map("PREVBALANCE")
  Credit                 Float    @map("CREDIT")
  InterestRate           Float    @map("INTERESTRATE")
  Taxes                  Float    @map("TAXES")
  SendReports            Int      @map("SEND_REPORTS")
  MetaQuotesClientID     Int      @default(0) @map("MQID") @db.UnsignedInt
  UserColor              Int      @map("USER_COLOR")
  Equity                 Float    @default(0) @map("EQUITY")
  Margin                 Float    @default(0) @map("MARGIN")
  MarginLevel            Float    @default(0) @map("MARGIN_LEVEL")
  FreeMargin             Float    @default(0) @map("MARGIN_FREE")
  Currency               String   @default("") @map("CURRENCY") @db.Char(16)
  ApiData                Bytes?   @map("API_DATA") @db.Blob
  ModifyTime             DateTime @map("MODIFY_TIME") @db.DateTime(0)

  @@index([Timestamp], map: "INDEX_STAMP")
  @@map("mt4_users")
}

model logs {
  ID          BigInt  @id @default(autoincrement())
  DateTime    BigInt?
  Level       BigInt?
  HostName    String? @db.LongText
  ProcessName String? @db.LongText
  Source      String? @db.LongText
  Content     String? @db.LongText

  @@index([HostName(length: 32)], map: "idx_Logs_HostName")
  @@index([Level], map: "idx_Logs_Level")
  @@index([ProcessName(length: 32)], map: "idx_Logs_ProcessName")
  @@index([Source(length: 32)], map: "idx_Logs_Source")
}

model mt4_config {
  CONFIG    Int     @id
  VALUE_INT Int?
  VALUE_STR String? @db.Char(255)
}

model ReportInfo {
  ID             Int      @id @default(autoincrement())
  ConfigJson     Json?
  Status         String // Status of the report (e.g., "Success", "Failed", etc.)
  ReportFileName String? // Name of the file that contains the report
  Progress       String?
  Error          String? // Optional field to capture error, set to null if no error
  ReportTime     DateTime // Date and time when the report was generated
  UpdatedAt      DateTime @updatedAt

  @@index([ReportTime], map: "INDEX_ReportTime")
  @@map("report_info")
}

model Configuration {
  ID        Int      @id @default(autoincrement())
  Type      String   @unique
  Value     Json
  Scope     String?
  CreatedAt DateTime
  UpdatedAt DateTime @updatedAt

  @@map("configurations")
}

model LatestBuild {
  ID          Int      @id @default(autoincrement())
  Version     Int
  Description String?
  ReleasedAt  String?
  CreatedAt   DateTime
  UpdatedAt   DateTime @updatedAt

  @@map("latest_build")
}
